<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>ZXCSS</title>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>


var columns = 12
,   decimalPlaces = 4
,   i
,   j
,   css = ''
,   spanClass = 's'
;

makeSpanClasses = function(o) {

    for (i = o.columns; i > 0; i--) {
        
        iclass = '.'+spanClass+i;
        
        css += iclass+' {width:100%;}';
        css += "\n";
        
        for (j = i - 1; j > 0; j--) {
            css += iclass+' .'+spanClass+j+' {width:'+applyDecimalPlaces(100*j/i, o.decimalPlaces)+'%}';
            css += "\n";
        }
    }
    return css;
}

/*
makeSpanClasses = function(o) {

    var widths = {};
    
    // Create an object where the properties are widths and the values are an array of objects with numerators and denominators
    for (i = o.columns; i > 0; i--) {
        j = i - 1;
        for (j; j > 0; j--) {
            width = applyDecimalPlaces(100*j/i, o.decimalPlaces);
            if (width <= 100) {
                if (!widths[width]) {
                    widths[width] = [];
                }
                widths[width].push({numerator:j, denominator:i});
            }
        }
    }
    // Create the widths classes
    notFirst = false;
    for (i in widths) {
        if (widths.hasOwnProperty(i)) {
            if (notFirst) {
                css += "\n";
            }
            else {
                notFirst = true;
            }
            widthsi = widths[i];
            
            for (j = 0; j < widthsi.length; j++) {
                if (j > 0) {
                    css += ', ';
                }
                css += '.'+spanClass+widthsi[j].denominator+' .'+spanClass+widthsi[j].numerator;
            }
        
            css += ' {width:'+i+'%;}';
        }
    }
    return css;
}
*/

$(function() {

    var css = makeSpanClasses({columns:columns,decimalPlaces:decimalPlaces});

    var el = $('.output').val(css)[0];
    
    el.style.height = "1px";
    el.style.height = (el.scrollHeight)+"px";
    
    $('.layout').each(function() {
        $(this).css({'backgroundColor':get_random_color()});
    });
    
    $('head').append('<style>'+css+'</style>');
    
    $('.csslength').html(css.length);

})
get_random_color = function() {
    var letters = '0123456789ABCDEF'.split('');
    var letters = 'ABCDEF'.split('');
    var color = '#';
    for (var i = 0; i < 6; i++ ) {
        color += letters[Math.round(Math.random() * 5)];
    }
    return color;
}

applyDecimalPlaces = function(num, decimalPlaces) {

    var scaler = Math.pow(10, decimalPlaces);
    return Math.floor(num * scaler)/scaler;
    
};

</script>


<style type="text/css">

/* Page Styles */

body {
	margin: 0;
	padding: 0;
	line-height: 20px;
	background: #fff;
}
textarea {display:block;width:90%;clear:both;}

.layout {min-height:40px;float:left;}

</style>


</head>

<body>

<h1>Blah</h1>

<div class="layout s12"><div>s12</div>
    <div class="layout s3"><div>s3</div>
    </div>
    <div class="layout s5"><div>s5</div>
    </div>
    <div class="layout s2"><div>s2</div>
    </div>
    <div class="layout s2"><div>s2</div>
    </div>
</div>

<div style="clear:both;"></div>

<div class="layout s7">
    <div>s7</div>
    <div class="layout s2"><div>s2</div>
    </div>
    <div class="layout s5"><div>s5</div>
        <div class="layout s3"><div>s3</div>
        </div>
        <div class="layout s2"><div>s2</div>
        </div>
    </div>
</div>

<div style="clear:both;"></div>

<p>Length: <span class="csslength"></span></p>
<textarea class="output">
</textarea>

</body>
</html>
