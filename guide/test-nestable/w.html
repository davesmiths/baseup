<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>ZXCSS</title>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>


var columns = 100
,   decimalPlaces = 4
,   i
,   j
,   css = ''
,   spanClass = 's'
;

applyDecimalPlaces = function(num, decimalPlaces) {

    var scaler = Math.pow(10, decimalPlaces);
    return Math.floor(num * scaler)/scaler;
    
};
makeWidthClasses = function(o) {

    var css = ''
    ,   i = 1
    ,   j
    ,   width
    ,   widths = {}
    ,   widthsi
    ,   notFirst;
    
    // Create an object where the properties are widths and the values are an array of objects with numerators and denominators
    for (i; i <= o.columns; i++) {
        j = 1;
        for (j; j <= o.columns; j++) {
            width = applyDecimalPlaces(100*i/j, o.decimalPlaces);
            if (width <= 100) {
                if (!widths[width]) {
                    widths[width] = [];
                }
                widths[width].push({numerator:i, denominator:j});
            }
        }
    }

    // Create the widths classes
    notFirst = false;
    for (i in widths) {
        if (widths.hasOwnProperty(i)) {
            if (notFirst) {
                css += "\n";
            }
            else {
                notFirst = true;
            }
            widthsi = widths[i];
            
            for (j = 0; j < widthsi.length; j++) {
                if (j > 0) {
                    css += ', ';
                }
                css += '.w'+widthsi[j].numerator+'o'+widthsi[j].denominator;
            }
        
            css += ' {width:'+i+'%;}';
        }
    }
    
    css += "\n";
    
    return css;
    
};

css = makeWidthClasses({columns:columns, decimalPlaces:decimalPlaces});


$(function() {
    var el = $('.output').val(css)[0];
    
    el.style.height = "1px";
    el.style.height = (el.scrollHeight)+"px";
    
    $('.layout').each(function() {
        $(this).css({'backgroundColor':get_random_color()});
    });
    
    $('head').append('<style>'+css+'</style>');
    
    $('.csslength').html(css.length);

})
function get_random_color() {
    var letters = '0123456789ABCDEF'.split('');
    var letters = 'ABCDEF'.split('');
    var color = '#';
    for (var i = 0; i < 6; i++ ) {
        color += letters[Math.round(Math.random() * 5)];
    }
    return color;
}
</script>


<style type="text/css">

/* Page Styles */

body {
	margin: 0;
	padding: 0;
	line-height: 20px;
	background: #fff;
}
textarea {display:block;width:90%;clear:both;}

.layout {min-height:40px;float:left;}

</style>


</head>

<body>

<h1>Blah</h1>

<div class="layout w12o12"><div>w12o12</div>
    <div class="layout w3o12"><div>w3o12</div>
    </div>
    <div class="layout w5o12"><div>w5o12</div>
    </div>
    <div class="layout w2o12"><div>w2o12</div>
    </div>
    <div class="layout w2o12"><div>w2o12</div>
    </div>
</div>

<div style="clear:both;"></div>

<div class="layout w7o7">
    <div>s7</div>
    <div class="layout w2o7"><div>s2</div>
    </div>
    <div class="layout w5o7"><div>s5</div>
        <div class="layout w3o5"><div>s3</div>
        </div>
        <div class="layout w2o5"><div>s2</div>
        </div>
    </div>
</div>

<div style="clear:both;"></div>

<p>Length: <span class="csslength"></span></p>
<textarea class="output">
</textarea>

</body>
</html>
